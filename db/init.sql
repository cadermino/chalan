-- MySQL Script generated by MySQL Workbench
-- Tue Dec  3 13:36:12 2019
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema chalan
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `chalan` ;

-- -----------------------------------------------------
-- Schema chalan
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `chalan` DEFAULT CHARACTER SET utf8 ;
USE `chalan` ;

-- -----------------------------------------------------
-- Table `order_details`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `order_details` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `type` enum('carry_from','deliver_to') NOT NULL,
  `floor_number` int(3) DEFAULT NULL,
  `order_id` int(11) NOT NULL,
  `street` varchar(45) DEFAULT NULL,
  `interior_number` varchar(45) DEFAULT NULL,
  `country` varchar(20) DEFAULT NULL,
  `map_url` varchar(400) DEFAULT NULL,
  `neighborhood` varchar(45) DEFAULT NULL,
  `city` varchar(45) DEFAULT NULL,
  `state` varchar(45) DEFAULT NULL,
  `zip_code` varchar(45) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `fk_order_details_order` (`order_id`),
  CONSTRAINT `fk_order_details_order` FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


-- -----------------------------------------------------
-- Table `carrier_company`
-- -----------------------------------------------------

CREATE TABLE IF NOT EXISTS `carrier_company` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(45) DEFAULT NULL,
  `rfc` varchar(13) NOT NULL DEFAULT '',
  `email` varchar(100) NOT NULL DEFAULT '',
  `address` varchar(200) NOT NULL,
  `active` tinyint(1) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- -----------------------------------------------------
-- Table `customers`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `customers` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(45) DEFAULT NULL,
  `paternal_last_name` varchar(45) DEFAULT NULL,
  `maternal_last_name` varchar(45) DEFAULT NULL,
  `email` varchar(45) DEFAULT NULL,
  `password` varchar(255) DEFAULT NULL,
  `mobile_phone` varchar(15) DEFAULT NULL,
  `phone` varchar(15) DEFAULT NULL,
  `created_date` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `email` (`email`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


-- -----------------------------------------------------
-- Table `lu_order_status`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `lu_order_status` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `status` varchar(45) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- -----------------------------------------------------
-- Table `lu_payment_type`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `lu_payment_type` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `type` varchar(45) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- -----------------------------------------------------
-- Table `orders`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `orders` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `customer_id` int(11) DEFAULT NULL,
  `product_id` int(11) DEFAULT NULL,
  `total_kilometers` int(20) DEFAULT NULL,
  `order_status_id` int(11) NOT NULL DEFAULT '1',
  `appointment_date` datetime DEFAULT CURRENT_TIMESTAMP,
  `comments` longtext,
  `updated_date` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `created_date` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `fk_orders_customers` (`customer_id`),
  KEY `fk_orders_lu_order_status1` (`order_status_id`),
  KEY `fk_products1` (`product_id`),
  CONSTRAINT `fk_orders_customers` FOREIGN KEY (`customer_id`) REFERENCES `customers` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `fk_orders_lu_order_status1` FOREIGN KEY (`order_status_id`) REFERENCES `lu_order_status` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `fk_products1` FOREIGN KEY (`product_id`) REFERENCES `products` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


-- -----------------------------------------------------
-- Table `payments`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `payments` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `amount` float DEFAULT NULL,
  `order_id` int(11) NOT NULL,
  `lu_payment_type_id` int(11) NOT NULL,
  `status` enum('pending','paid','cancelled') NOT NULL DEFAULT 'pending',
  `reference` varchar(100) DEFAULT NULL COMMENT 'Stripe session id',
  `created_date` datetime DEFAULT CURRENT_TIMESTAMP,
  `comments` longtext,
  `active` tinyint(4) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `fk_payments_orders1` (`order_id`),
  KEY `fk_payments_lu_payment_type1` (`lu_payment_type_id`),
  CONSTRAINT `fk_payments_lu_payment_type1` FOREIGN KEY (`lu_payment_type_id`) REFERENCES `lu_payment_type` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `fk_payments_orders1` FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


-- -----------------------------------------------------
-- Table `vehicles`
-- -----------------------------------------------------

CREATE TABLE IF NOT EXISTS `vehicles` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `charge_per_kilometer` int(10) NOT NULL,
  `charge_per_floor` int(10) NOT NULL,
  `driver_fee` int(10) NOT NULL COMMENT 'base load price',
  `loader_fee` int(10) NOT NULL COMMENT 'fee per loader',
  `loaders_quantity` int(2) NOT NULL COMMENT 'quantity of loaders',
  `size` enum('small','medium','large') DEFAULT NULL,
  `weight` varchar(45) DEFAULT NULL COMMENT 'weight in kilograms',
  `width` varchar(45) DEFAULT NULL,
  `height` varchar(45) DEFAULT NULL,
  `length` varchar(45) DEFAULT NULL,
  `brand` varchar(45) DEFAULT NULL,
  `model` varchar(45) DEFAULT NULL,
  `carrier_company_id` int(11) NOT NULL,
  `description` varchar(200) DEFAULT NULL,
  `picture` varchar(200) DEFAULT NULL,
  `plates` varchar(45) DEFAULT NULL,
  `base_address` varchar(200) DEFAULT NULL,
  `active` tinyint(1) DEFAULT '0',
  PRIMARY KEY (`id`),
  KEY `fk_carrier_company` (`carrier_company_id`),
  CONSTRAINT `fk_carrier_company` FOREIGN KEY (`carrier_company_id`) REFERENCES `carrier_company` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- -----------------------------------------------------
-- Table `products`
-- -----------------------------------------------------

CREATE TABLE IF NOT EXISTS `products` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `vehicle_id` int(11) NOT NULL,
  `price` float DEFAULT NULL,
  `total_kilometers` int(20) DEFAULT NULL,
  `description` varchar(500) DEFAULT NULL,
  `active` tinyint(4) NOT NULL,
  `updated_date` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `created_date` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `fk_vehicle1` (`vehicle_id`),
  CONSTRAINT `fk_vehicle1` FOREIGN KEY (`vehicle_id`) REFERENCES `vehicles` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


-- -----------------------------------------------------
-- Table `calculated_distance`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `calculated_distance` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `address_origin` varchar(200) DEFAULT NULL,
  `address_destination` varchar(200) DEFAULT NULL,
  `kilometers` int(5) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;



CREATE TABLE IF NOT EXISTS `sepomex` (
  `id` mediumint(8) unsigned NOT NULL AUTO_INCREMENT,
  `id_estado` smallint(5) unsigned NOT NULL,
  `estado` varchar(35) NOT NULL,
  `id_municipio` smallint(5) unsigned NOT NULL,
  `municipio` varchar(60) NOT NULL,
  `ciudad` varchar(60) DEFAULT NULL,
  `zona` varchar(15) NOT NULL,
  `cp` mediumint(9) NOT NULL,
  `asentamiento` varchar(70) NOT NULL,
  `tipo` varchar(40) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;